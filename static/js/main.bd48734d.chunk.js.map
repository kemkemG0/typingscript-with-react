{"version":3,"sources":["features/game.ts","components/style.ts","components/AlphabetLabel.tsx","components/RawStringLabel.tsx","components/GameInfo.tsx","components/GameStage.tsx","components/InitialStage.tsx","components/ResultStage.tsx","App.tsx","index.tsx"],"names":["contents","initialState","contentsID","rawString","alphabetString","listeningCharIndex","allInputCount","doneCharCount","displayType","timeCount","gameSlice","createSlice","name","reducers","keypressed","state","action","pressedKeyCode","payload","listeningChar","String","fromCharCode","length","changeDisplayType","setTimeCount","actions","game","padding","borderRadius","background","margin","width","height","textAlign","position","gamedisplay","transform","top","left","textblock","letterSpacing","fontSize","gameinfo","color","right","done","AlphabetLabel","ind","useSelector","alphabets","doneAlpha","substr","yetAlpha","style","RawStringLabel","GameInfo","allCount","result","dispatch","useDispatch","nowTime","performance","now","prevTime","useEffect","timer","setInterval","clearInterval","toFixed","GameStage","keyLog","useCallback","event","keyCode","window","addEventListener","removeEventListener","InitialStage","ResultStage","score","type","onClick","App","store","configureStore","reducer","ReactDOM","render","StrictMode","className","document","getElementById"],"mappings":"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","file":"static/js/main.bd48734d.chunk.js","sourcesContent":["/* eslint-disable no-param-reassign */\nimport { createSlice } from \"@reduxjs/toolkit\";\n\nexport interface GameState {\n  contentsID: number;\n  rawString: string;\n  alphabetString: string;\n  listeningCharIndex: number;\n  allInputCount: number;\n  doneCharCount: number;\n  displayType: \"INIT\" | \"GAME\" | \"RESULT\";\n  timeCount: number;\n}\n\nconst contents: string[][] = [\n  [\"こんにちは世界\", \"KONNNITIHASEKAI\"],\n  [\"22こんにちは世界22\", \"22KONNNITIHASEKAI22\"],\n  [\"33こんにちは世界33\", \"33KONNNITIHASEKAI33\"],\n  [\"44こんにちは世界44\", \"44KONNNITIHASEKAI44\"],\n  [\"55こんにちは世界55\", \"55KONNNITIHASEKAI55\"],\n  [\"66こんにちは世界66\", \"66KONNNITIHASEKAI66\"],\n];\n\nconst initialState: GameState = {\n  contentsID: 0,\n  rawString: contents[0][0],\n  alphabetString: contents[0][1],\n  listeningCharIndex: 0,\n  allInputCount: 0,\n  doneCharCount: 0,\n  displayType: \"INIT\",\n  timeCount: 0,\n};\n\n// createSliceとは、actionの定義とaction creator,reducerをまとめて生成できる。\nexport const gameSlice = createSlice({\n  name: \"game\",\n  initialState,\n  reducers: {\n    keypressed: (state, action) => {\n      const { pressedKeyCode } = action.payload;\n      const listeningChar = state.alphabetString[state.listeningCharIndex];\n\n      // Redux Tool Kitではstateを直接変更してもOK！！\n      state.allInputCount += 1;\n\n      if (String.fromCharCode(pressedKeyCode) === listeningChar) {\n        state.listeningCharIndex += 1;\n        state.doneCharCount += 1;\n      }\n      if (state.listeningCharIndex === state.alphabetString.length) {\n        state.listeningCharIndex = 0;\n        state.contentsID += 1;\n        if (state.contentsID !== contents.length)\n          [state.rawString, state.alphabetString] = contents[state.contentsID];\n        else {\n          state.displayType = \"RESULT\";\n        }\n      }\n    },\n    changeDisplayType: (state, action) => {\n      if (action.payload === \"INIT\") {\n        state = initialState;\n      } else state.displayType = action.payload;\n      return state;\n    },\n    setTimeCount: (state, action) => {\n      state.timeCount = action.payload;\n    },\n  },\n});\n\nexport const { keypressed, changeDisplayType, setTimeCount } =\n  gameSlice.actions;\n","import React from \"react\";\n\nexport const game: React.CSSProperties = {\n  padding: \"0.5em\",\n  borderRadius: \"1em\",\n  background: \"lightslategray\",\n  margin: \"150px auto\",\n  width: \"600px\",\n  height: \"400px\",\n  textAlign: \"center\",\n  position: \"relative\",\n};\n\nexport const gamedisplay: React.CSSProperties = {\n  background: \"lavender\",\n  position: \"absolute\",\n  width: \"90%\",\n  height: \"50%\",\n  borderRadius: \"1em\",\n\n  transform: \"translate(-50%, -50%)\",\n  top: \"50%\",\n  left: \"50%\",\n};\nexport const times: React.CSSProperties = {\n  position: \"absolute\",\n  margin: \"0.1rem\",\n  padding: \"1.5rem\",\n};\nexport const textblock: React.CSSProperties = {\n  letterSpacing: \"5px\",\n  position: \"absolute\",\n  width: \"100%\",\n  top: \"45%\",\n  left: \"50%\",\n  transform: \"translate(-50%, 0%)\",\n  fontSize: \"25px\",\n};\n\nexport const gameinfo: React.CSSProperties = {\n  color: \"white\",\n  position: \"absolute\",\n  top: \"10%\",\n  right: \"10%\",\n};\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { GameState } from \"../features/game\";\n\nconst done: React.CSSProperties = {\n  color: \"darkgray\",\n};\n\nconst AlphabetLabel: React.FC = () => {\n  const ind = useSelector((state: GameState) => state.listeningCharIndex);\n  const alphabets = useSelector((state: GameState) => state.alphabetString);\n\n  const doneAlpha = alphabets.substr(0, ind);\n  const yetAlpha = alphabets.substr(ind);\n\n  return (\n    <div>\n      <span style={done}>{doneAlpha}</span>\n      <span>{yetAlpha}</span>\n    </div>\n  );\n};\n\nexport default AlphabetLabel;\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { GameState } from \"../features/game\";\n\nconst RawStringLabel: React.FC = () => {\n  const rawString = useSelector((state: GameState) => state.rawString);\n  return <div>{rawString}</div>;\n};\n\nexport default RawStringLabel;\n","import React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { GameState, setTimeCount } from \"../features/game\";\n\nconst GameInfo: React.FC = () => {\n  const allCount = useSelector((state: GameState) => state.allInputCount);\n  const okCount = useSelector((state: GameState) => state.doneCharCount);\n  const result = (okCount / allCount) * 100 || 0;\n\n  const dispatch = useDispatch();\n\n  const nowTime = useSelector((state: GameState) => state.timeCount);\n  if (nowTime === 0) dispatch(setTimeCount(performance.now()));\n  const prevTime = useSelector((state: GameState) => state.timeCount);\n\n  // let prevTime = 0;\n  // if (nowTime === 0) prevTime = performance.now();\n  // if (nowTime !== 0) prevTime = nowTime;\n\n  useEffect(() => {\n    const timer = setInterval(() => {\n      dispatch(setTimeCount((performance.now() - prevTime) / 1000));\n    }, 5);\n    return () => clearInterval(timer);\n  }, []);\n\n  return (\n    <>\n      経過時間:{nowTime.toFixed(2)}秒<div>正答率は{result.toFixed(2)}%です</div>\n    </>\n  );\n};\n\nexport default GameInfo;\n","import React, { useEffect, useCallback } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { game, gamedisplay, gameinfo, textblock } from \"./style\";\nimport AlphabetLabel from \"./AlphabetLabel\";\nimport RawStringLabel from \"./RawStringLabel\";\nimport GameInfo from \"./GameInfo\";\nimport { keypressed } from \"../features/game\";\n\nconst GameStage: React.FC = () => {\n  const dispatch = useDispatch();\n  const keyLog = useCallback((event) => {\n    const payload: { pressedKeyCode: number } = {\n      pressedKeyCode: event.keyCode,\n    };\n\n    dispatch(keypressed(payload));\n  }, []);\n\n  useEffect(() => {\n    // 最初だけ登録してる\n    window.addEventListener(\"keydown\", keyLog, false);\n    return () => {\n      window.removeEventListener(\"keydown\", keyLog, false);\n    };\n  }, []);\n\n  return (\n    <div style={game}>\n      <div style={gameinfo}>\n        <GameInfo />\n      </div>\n      <div style={gamedisplay}>\n        <div style={textblock}>\n          <RawStringLabel />\n          <AlphabetLabel />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default GameStage;\n","import React, { useCallback, useEffect } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { changeDisplayType } from \"../features/game\";\nimport { game, gamedisplay, textblock } from \"./style\";\n\nconst InitialStage: React.FC = () => {\n  const dispatch = useDispatch();\n\n  const keyLog = useCallback((event) => {\n    const payload = \"GAME\";\n    if (event.keyCode === 32 || event.keyCode === 13)\n      dispatch(changeDisplayType(payload));\n  }, []);\n  // キープッシュのイベントリスナー登録\n  useEffect(() => {\n    // 最初だけ登録してる\n    window.addEventListener(\"keydown\", keyLog, false);\n    return () => {\n      window.removeEventListener(\"keydown\", keyLog, false);\n    };\n  }, []);\n\n  return (\n    <div style={game}>\n      <div style={gamedisplay}>\n        <div style={textblock}>SpaceまたはEnterを押してください</div>\n      </div>\n    </div>\n  );\n};\n\nexport default InitialStage;\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { changeDisplayType, GameState } from \"../features/game\";\nimport { game, gamedisplay, gameinfo, textblock } from \"./style\";\n\nconst ResultStage: React.FC = () => {\n  const { allInputCount, doneCharCount, timeCount } = useSelector(\n    (state: GameState) => state\n  );\n  const result = (doneCharCount / allInputCount) * 100 || 0;\n  const score = (result * result * result) / timeCount / 10;\n  const dispatch = useDispatch();\n  return (\n    <div style={game}>\n      <div style={gameinfo}>\n        <br />\n        入力数:{allInputCount} 正解数:{doneCharCount}ミス:\n        {allInputCount - doneCharCount}正答率:{result.toFixed(2)}%\n      </div>\n      <div style={gamedisplay}>\n        <div>TIME:{timeCount.toFixed(2)}秒</div>\n        <div style={textblock}>\n          SCORE: {score.toFixed(0)}\n          <div>\n            <button\n              type=\"button\"\n              onClick={() => {\n                dispatch(changeDisplayType(\"INIT\"));\n              }}\n            >\n              PLAY AGAIN\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ResultStage;\n","import { useSelector } from \"react-redux\";\nimport React from \"react\";\nimport GameStage from \"./components/GameStage\";\nimport \"./App.css\";\nimport { GameState } from \"./features/game\";\nimport InitialStage from \"./components/InitialStage\";\nimport ResultStage from \"./components/ResultStage\";\n\nconst App: React.FC = () => {\n  switch (useSelector((state: GameState) => state.displayType)) {\n    case \"INIT\":\n      return <InitialStage />;\n    case \"GAME\":\n      return <GameStage />;\n    default:\n      return <ResultStage />;\n  }\n};\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport { Provider } from \"react-redux\";\nimport { configureStore } from \"@reduxjs/toolkit\";\nimport { gameSlice } from \"./features/game\";\nimport App from \"./App\";\n\n// ストアにReducerを登録?\nconst store = configureStore({ reducer: gameSlice.reducer });\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <div className=\"container\">\n        <App />\n      </div>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\") as HTMLElement\n);\n"],"sourceRoot":""}